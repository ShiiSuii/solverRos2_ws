<root main_tree_to_execute="MainTree">
  <BehaviorTree ID="MainTree">

    <!-- Secuencia principal de navegación con recuperación -->
    <RecoveryNode number_of_retries="4" name="NavigateRecovery">

      <!-- Planificación + seguimiento con replan -->
      <PipelineSequence name="NavigateWithReplanning">
        <GoalUpdated/>
        <ComputePathToPose goal="{goal}" path="{path}"/>
        <FollowPath path="{path}" path_updated="{path_updated}"/>
      </PipelineSequence>

      <!-- 1️⃣ BackUp: retrocede 30 cm a -0.15 m/s -->
      <BackUp target="0.30" speed="-0.15"/>

      <!-- 2️⃣ Limpieza de costmaps (por si hay obstáculos fantasma) -->
      <ClearCostmap service_name="local_costmap/clear"/>
      <ClearCostmap service_name="global_costmap/clear"/>

      <!-- 3️⃣ Spin: rota 90° para reorientarse -->
      <Spin spin_dist="1.57"/>

      <!-- 4️⃣ Espera breve para estabilizar sensores -->
      <Wait wait_duration="2"/>

    </RecoveryNode>
  </BehaviorTree>
</root>

